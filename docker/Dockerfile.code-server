FROM codercom/code-server:latest

# Switch to root to install packages and set permissions
USER root

RUN apt-get update && apt-get install -y git

COPY ./docker/startup.sh /usr/local/bin/startup.sh
RUN chmod +x /usr/local/bin/startup.sh

# Revert to default non-root user
USER coder

ENTRYPOINT ["/usr/local/bin/startup.sh"]
